<!DOCTYPE html>
<html lang="ch">
  <head>
    <meta charset="utf-8" />
<title></title>
<meta name="description" 
      content=""
>

  




<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link
  rel="alternate"
  type="application/rss+xml"
  href="https://schecterdamien.github.io/index.xml"
  title=""
/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content=""/>



<link rel="stylesheet" href="https://schecterdamien.github.io/fontawesome/css/all.min.css" />




<link
  crossorigin="anonymous"
  href="/css/styles.min.css"
  integrity=""
  rel="preload stylesheet"
  as="style"
/>




<link
  id="dark-mode-theme"
  crossorigin="anonymous"
  href="/css/dark.min.css"
  integrity=""
  rel="preload stylesheet"
  as="style"
/>


<script>
  var darkTheme = document.getElementById('dark-mode-theme')
  var storedTheme = localStorage.getItem('dark-mode-storage')

  if (storedTheme === 'dark') {
    darkTheme.disabled = false
  } else if (storedTheme === 'light') {
    darkTheme.disabled = true
  }
</script>


<script defer crossorigin="anonymous" src="/js/theme.js" integrity=""></script>


<script defer crossorigin="anonymous" src="/js/instantpage.min.js" integrity=""></script><meta name="generator" content="Hugo 0.101.0" />
  </head>
  <body>
    
  
    
  
  



  <div class="intro-header"></div>


    
  <div class="container" role="main">
    <div class="posts-list">
      
        
        

      
        <article class="post-preview">
  <a href="https://schecterdamien.github.io/posts/2018/namedtuple/">
    <h2 class="post-title">namedtuple第一个参数有什么用？</h2>
  </a>
  <div class="post-entry">
    
      <p>namedtuple是python中一个简单实用的数据结构，但是很不爽的是每次使用的时候都需要给第一个参数指定一个字符串，而这个字符串在实际使用中似乎并没有什么作用。比如
&gt;&gt;&gt; from collections import namedtuple &gt;&gt;&gt; Student = namedtuple(&#39;StudentTuple&#39;, [&#39;sex&#39;, &#39;name&#39;, &#39;age&#39;]) &gt;&gt;&gt; s = Student(&#39;male&#39;, &#39;callmedad&#39;, 22) &gt;&gt;&gt; s.age 22 我操作的对象都是Student，而不是StudentTuple，那我为什么还要传一个&rsquo;StudentTuple&rsquo;，这个字符串似乎对我没有任何帮助。stackoverflow同样有人提了这个问题：传送门1，传送门2. 看了下回答，然后又看了下namedtuple的源码，总算明白了。 接着上面的代码，我们可以看下Student是个啥。
&gt;&gt;&gt; import inspect &gt;&gt;&gt; inspect.isclass(Student) True &gt;&gt;&gt; Student &lt;class &#39;__main__.StudentTuple&#39;&gt; &gt;&gt;&gt; Student &lt;class &#39;__main__.StudentTuple&#39;&gt; &gt;&gt;&gt; s.__class__ &lt;class &#39;__main__.StudentTuple&#39;&gt; &gt;&gt;&gt; type(namedtuple) &lt;class &#39;function&#39;&gt; 我们大致知道这几点：1. Student是个类，并且只是一个类的引用，查看s.__class__知道，这个类定义的名字是StudentTuple，就是我们传的第一个参数。2. namedtuple是个方法，但是返回的是一个新的类，也就是说这是一个类的工厂方法。
既然是一个生成类的工厂方法，那么肯定就需要知道类的名字，所以这就是第一个参数的意义。然后，这一切是怎么实现的呢？
看下namedtuple的源码，其实非常简单粗暴
def namedtuple(typename, field_names, *, verbose=False, rename=False, module=None): ... class_definition = _class_template.format( typename = typename, # 第一个参数 field_names = tuple(field_names), # 各种检验后的属性列表 num_fields = len(field_names), arg_list = repr(tuple(field_names)).</p>
      <a href="https://schecterdamien.github.io/posts/2018/namedtuple/" class="post-read-more"
        ></a
      >
    
  </div>

  <div class="postmeta">
    <span class="meta-post">
  <em class="fa fa-calendar-alt"></em
  >&nbsp;Dec 19, 2018
  
</span>

  </div>
</article>

      
        <article class="post-preview">
  <a href="https://schecterdamien.github.io/posts/2018/about-absurd/">
    <h2 class="post-title">关于语言的杂想</h2>
  </a>
  <div class="post-entry">
    
  </div>

  <div class="postmeta">
    <span class="meta-post">
  <em class="fa fa-calendar-alt"></em
  >&nbsp;Nov 19, 2018
  
</span>

  </div>
</article>

      
        <article class="post-preview">
  <a href="https://schecterdamien.github.io/posts/2018/interval-tree/">
    <h2 class="post-title">判断多个区间是否有重叠</h2>
  </a>
  <div class="post-entry">
    
      <p>今天遇到个需求，大致意思是前端给我一堆商品按照阶梯定价的规则，比如订单数为0-200，价格是10块，订单数200-300，价格是8块……简化的数据结构是这样的：
[ { &#34;min_orders&#34;: 0, &#34;max_orders&#34;: 200, &#34;price&#34;: 10 }, { &#34;min_orders&#34;: 200, &#34;max_orders&#34;: 300, &#34;price&#34;: 8 }, { &#34;min_orders&#34;: 400, &#34;max_orders&#34;: 500, &#34;price&#34;: 7 } ] 我需要对前端传的数据做校验，其中有一部分就是不同阶的上下界不能有交叉（前端给的阶梯数据不一定有序），比如有0-200的阶梯，如果再有100-300的阶梯那这个数据就有问题，因为没法定价。抽象出来问题其实就是判断多个区间（可能不连续）是否有重叠。
初一看，这个问题其实很简单，两个for循环，第一层记住遍历过的区间，第二层把当前区间和之前遍历的区间一个个比较看是否交叉就可以了。这么做当然没问题，但是时间复杂度是O(n^2)，怎么看都觉得应该有更好的解决办法，第一遍的遍历是怎么都省不了的，所以优化到极致也不可能比O(n)低，第二遍其实就是个比较的过程，既然是比较的话，那就有思路了，可以联想到很多类似的问题，本质上和排序问题是差不多的。
在stackoverflow看到一个相同的问题：search for interval overlap in list of intervals?。里面提到了一个办法：可以先对区间以左端点进行排序，然后再遍历区间，比较当前区间的左端点和上一个区间的右端点，如果当前的左端点比上一个右端点小，那么一定就有重叠的部分。第一遍排序时间复杂度是O(nlogn)，第二遍遍历时间复杂度是O(n)，所以总体的还是O(nlogn)，比如：
[(4,6), (7,9), (1,5), (6,7)] 排序完之后是：
[(1,5), (4,6), (6,7), (7,9)] 然后进行遍历比较，遍历到第二个区间的时候，左端点是4，比上个区间的右端点5要小，所以肯定有重叠的部分。
第二种办法是构建区间树，上面说的效率最低的那种解决办法，第二层for循环是比较，既然是比较，那么就可以通过树这种结构来提高比较的效率，而不用和前面所有区间进行比较，所以很自然就想到可以构建一个二叉排序树，树的叶节点是每个区间。同时，树的查询效率和树的深度是有关系的，所以构建一个相对平衡的二叉排序树也能进一步提高效率，比如红黑树。算法导论上介绍了这种数据结构，节点是区间的红黑树——区间树。
红黑树实现起来还是很麻烦的，找了一圈发现github上有现成的轮子——intervaltree，使用非常简单：
&gt;&gt;&gt; from intervaltree import Interval, IntervalTree &gt;&gt;&gt; tree = IntervalTree() &gt;&gt;&gt; iv = Interval(4, 7) &gt;&gt;&gt; tree.add(iv) &gt;&gt;&gt; target_iv = Interval(5, 8) &gt;&gt;&gt; tree.</p>
      <a href="https://schecterdamien.github.io/posts/2018/interval-tree/" class="post-read-more"
        ></a
      >
    
  </div>

  <div class="postmeta">
    <span class="meta-post">
  <em class="fa fa-calendar-alt"></em
  >&nbsp;Oct 10, 2018
  
</span>

  </div>
</article>

      
        <article class="post-preview">
  <a href="https://schecterdamien.github.io/posts/2018/first-post/">
    <h2 class="post-title">我的第一篇博客</h2>
  </a>
  <div class="post-entry">
    
  </div>

  <div class="postmeta">
    <span class="meta-post">
  <em class="fa fa-calendar-alt"></em
  >&nbsp;Sep 19, 2018
  
</span>

  </div>
</article>

      
    </div>
    
      <ul class="pager">
        
          <li class="previous">
            
              <a href="https://schecterdamien.github.io/page/1/"
                >&larr; </a
              >
            
          </li>
        
        
      </ul>
    
  </div>

    <footer>
  

<div class="social-icons">
  
    
    
      
      <a href="link%20to%20social%20media" name="name of social media">
        <em class="A icon from https://fontawesome.com/"></em>
      </a>
    
  

  
</div>


  
  <div class="container">
    <p class="credits copyright">
      <a href="https://schecterdamien.github.io/about">wujinjing</a>
      &nbsp;&copy;
      2021
      
      &nbsp;&ndash;&nbsp;
      <em class="fas fa-moon" id="dark-mode-toggle"></em>
    </p>

    <p class="credits theme-by">
       <a href="https://gohugo.io">Hugo</a>&nbsp;
      
      <a href="https://github.com/matsuyoshi30/harbor">Harbor</a>
    </p>
  </div>
</footer>

  </body>
</html>
